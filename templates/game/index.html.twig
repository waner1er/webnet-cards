{% extends 'base.html.twig' %}

{% block title %}Jeu de Cartes{% endblock %}

{% block body %}
<main class="{{ result ? 'results-shown' : '' }}">
    <header style="text-align: center;">
        <h1>Jeu de Cartes</h1>
        <p>Tirez des cartes et découvrez l'ordre aléatoire de tri !</p>
    </header>

    <section class="form-container">
        <form method="post" class="game-form">
            <label for="card_count">
                <b>Combien de cartes voulez-vous tirer ?</b>
                <small>Entre 1 et 52 cartes</small>
            </label>
            <input 
                type="number" 
                id="card_count" 
                name="card_count" 
                min="1" 
                max="52" 
                value="10"
                required
            >
            <button type="submit"> Tirer les cartes</button>
        </form>

        {% if error %}
            <aside class="error-message">
                <strong>Erreur :</strong> {{ error }}
            </aside>
        {% endif %}
    </section>

    {% if result %}
    <div class="grid-two-columns">
        <section class="game-section">
            <h2>Main non triée ({{ result.non_sorted|length }} cartes)</h2>
            <p>Ordre de tirage du paquet mélangé</p>
            <div class="cards-grid">
                {% for card in result.non_sorted %}
                    {% set suit_class = card.getSuit().value|lower %}
                    {% set suit_symbol = 'suit-' ~ card.getSuit().value|lower %}
                    <div class="playing-card {{ suit_class }}">
                        <div class="card-value">{{ card.getValue().label }}</div>
                        <div class="card-suit">
                            <span class="{{ suit_symbol }}"></span>
                        </div>
                        <div class="card-value" style="transform: rotate(180deg);">{{ card.getValue().label }}</div>
                    </div>
                {% endfor %}
            </div>
        </section>

        <section class="game-section sorted">
            <h2>✨ Main triée ({{ result.sorted|length }} cartes)</h2>
            <p >Classée selon les règles aléatoires ci-dessus</p>
            <div class="cards-grid">
                {% for card in result.sorted %}
                    {% set suit_class = card.getSuit().value|lower %}
                    {% set suit_symbol = 'suit-' ~ card.getSuit().value|lower %}
                    <div class="playing-card {{ suit_class }}">
                        <div class="card-value">{{ card.getValue().label }}</div>
                        <div class="card-suit">
                            <span class="{{ suit_symbol }}"></span>
                        </div>
                        <div class="card-value" style="transform: rotate(180deg);">{{ card.getValue().label }}</div>
                    </div>
                {% endfor %}
            </div>
        </section>
</div>
        <section style="text-align: center;">
            <a href="{{ path('card_game') }}" class="new-game-btn">
                Nouvelle partie
            </a>
        </section>
    {% endif %}
</main>
{% endblock %}